---
title: "CORS란 무엇인가?"
categories:
    - Develope
tags:
    - HTTP
---

# CORS란?

Cross-Origin Resource Sharing(CORS)은 추가적인 HTTP header를 사용해서 애플리케이션이 다른 origin의 리소스에 접근할 수 있도록 하는 메커니즘을 말한다.<br>
하지만 다른 origin에서 내 리소스에 함부로 접근하지 못하게 하기 위해 사용된다.
![image](https://user-images.githubusercontent.com/69573484/139261786-37297837-38c4-4bee-8c6e-90cf62272b39.png)

# 요청 헤더 목록

- **Access-Control-Allow-Origin** : 요청을 허용하는 출처 ( * 와일드 카드이면 모든 곳에서 허용, 특정하려면 프로토콜 + 호스트 + 포트번호 입력)
- **Access-Control-Allow-Credentials** : 클라이언트 요청이 쿠키를 통해서 자격 증명을 하는 경우에 true, true를 응답받은 클라이언트는 실제 요청 시 서버에서 정의된 규격의 인증값이 담긴 쿠키를 같이 보내야 한다.
- **Access-Control-Expose-Headers** : 클라이언트 요청에 포함되어도 되는 사용자 정의 헤더
- **Access-Control-Max-Age** : 클라이언트에서 Preflight 의 요청 결과를 저장할 기간을 지정, 클라이언트에서 Preflight 요청의 결과를 저장하고 있을 시간이다. 해당 시간 동안은 Preflight 요청을 다시 하지 않게된다.
- **Access-Control-Allow-Methods** : 요청을 허용하는 메서드, 기본값은 GET, POST라고 보면된다. 이 헤더가 없으면 GET과 POST요청만 가능하다. 만약 이 헤더가 지정되어 있으면 클라이언는 헤더 값에 해당하는 메서드일 경우에만 실제 요청을 시도한다.
- **Access-Control-Allow-Headers** : 요청을 허용하는 헤더. <br>
# CORS는 왜 필요한가?
- 예전에는 자원을 저장하는 서버와 웹 페이지가 하나의 서버에서 만들어졌다.
- 때문에 해당 서버의 자원은 해당 도메인에서만 요청하는 것이 당연했다.
- 당연히 보안을 위해서 브라우저는 다른 도메인에서 서버의 자원을 요청할 경우를 막아 놓았다.
- 그런데 시간이 지나 웹 기술이 발전하였고 페이지와 자원을 분리하거나 다른 서버의 자원을 요청을 보내는 경우가 많이 생겼다.
- 어떻게 했냐하면 개발자들은 편법을 이용해서 다른 서버의 자원을 가져다썼다. (편법의 설명은 생략한다.)
- 이런 일이 많아졌다고 브라우저에서 편법을 막아버리면 여러 사이트에서 문제가 발생할 수 있기 때문에 웹 브라우저에서 외부 도메인 서버와 통신하기 위한 방식을 표준화한 것을 만들었다.
- 브라우저는 편법을 쓰기보다는 공식적으로 외부 도메인 자원을 가져다 쓰라고 만든것이 CORS이다.
- 이러한 교차 출처 자원 공유 방식은 요청을 받은 웹서버가 허용할 경우에는 다른 도메인에서도 자원을 주고 받을 수 있게 해준다. <br>
# CORS는 어떻게 동작하나?
- 브라우저가 리소스를 요청할 때 추가적인 헤더에 정보를 담는다.
- 내 origin은 무엇이고 어떤 메소드를 사용해서 요청을 할 것이고 어떤 헤더들을 포함할 것인지를 담아서 서버에 전한다.
- 서버는 서버가 응답할 수 있는 origin들을 헤더에 담아서 브라우저에게 보낸다.
- 브라우저가 이 헤더를 보고 해당 origin에서 요청할 수 있다면 리소스 전송을 허용하고 만약 불가능하다면 에러를 발생시킨.

